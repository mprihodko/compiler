window.ajaxURL="/wp-admin/admin-ajax.php",function(a){a(document).ready(function(){var b={testFtp:function(){a(".test_ftp a").on("click",function(b){b.preventDefault();var c={};c={ftp_hostname:a(".ftp_row #ftp_hostname").val(),ftp_username:a(".ftp_row #ftp_username").val(),ftp_password:a(".ftp_row #ftp_password").val(),mysql_host:a(".sql_row #mysql_host").val(),mysql_database:a(".sql_row #mysql_database").val(),mysql_username:a(".sql_row #mysql_username").val(),mysql_password:a(".sql_row #mysql_password").val()};var d=[];a.each(c,function(b,c){c?"type"==b?a("#"+b).css("background","#FFF"):a("#"+b).css("background","#F2F2F2"):(a("#"+b).css("background","rgba(255,0,0,0.2)"),d.push(b))}),0==d.length&&(a("body").waiting({fixed:!0}),a.ajax({type:"POST",url:ajaxURL,data:{action:"validate_servers",testing_connect:"test",server_data:c},success:function(b){var c=a.parseJSON(b);1==c.ftp?a("#connectionResult").html("<span class='connected'>"+c.ftp_message+"</span>"):a("#connectionResult").html("<span class='fail_connect'>"+c.ftp_message+"</span>"),1==c.db?a("#connectionResult").append("<span class='connected db_status'>"+c.db_message+"</span>"):"wrong"==c.db?a("#connectionResult").append("<span class='fail_connect db_status'>"+c.db_message+"</span>"):a("#connectionResult").append("<span class='warning_connect db_status'>"+c.db_message+"</span>"),a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting")},error:function(){a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting")}}))})},nextStep:function(b){var c={};a("#tabsTemp div:nth-child(2)").hasClass("active")&&(c={type:a(".type_app:checked").val(),site_url:a(".ftp_row #site_url").val(),ftp_hostname:a(".ftp_row #ftp_hostname").val(),ftp_username:a(".ftp_row #ftp_username").val(),ftp_password:a(".ftp_row #ftp_password").val(),mysql_host:a(".sql_row #mysql_host").val(),mysql_database:a(".sql_row #mysql_database").val(),mysql_username:a(".sql_row #mysql_username").val(),mysql_password:a(".sql_row #mysql_password").val(),step:"1"}),a("#tabsTemp div:nth-child(3)").hasClass("active")&&(c={site_name:a("#site_name").val(),site_tagline:a("#site_tagline").val(),site_email:a("#site_email").val(),site_meta_desc:a("#site_meta_desc").val(),admin_name:a("#admin_name").val(),admin_password:a("#admin_password").val(),admin_nickname:a("#admin_nickname").val(),step:"2"}),a("#tabsTemp div:nth-child(4)").hasClass("active")&&(c={facebook:a("#facebook").val(),twitter:a("#twitter").val(),linkedin:a("#linkedin").val(),google:a("#google").val(),youtube:a("#youtube").val(),step:"3"}),a("#tabsTemp div:nth-child(5)").hasClass("active")&&(c={company_name:a("#company_name").val(),street:a("#street").val(),city:a("#city").val(),state:a("#state").val(),zip:a("#zip").val(),phone:a("#phone").val(),step:"4"});var d=[];3!=c.step&&4!=c.step&&a.each(c,function(b,c){c?"type"==b?a("#"+b).css("background","#FFF"):a("#"+b).css("background","#F2F2F2"):"site_meta_desc"!==b&&(a("#"+b).css("background","rgba(255,0,0,0.2)"),d.push(b))}),0==d.length&&(a("body").waiting({fixed:!0}),a("#connectionResult").html(""),a.ajax({type:"POST",url:ajaxURL,data:{action:"validate_servers",server_data:c},success:function(b){var c=a.parseJSON(b),d=[],e=[];a.each(c,function(b,c){("ftp"==b&&"ok"!=c||"db_connect"==b&&"ok"!=c)&&(e.push(b),a("#connectionResult").append("<span class='warning_connect db_status'>"+c+"</span><br>")),0==c||"false"==c?(a("#"+b).css("background","rgba(255,0,0,0.2)"),d.push(b)):"type"==b?a("#"+b).css("background","#FFF"):a("#"+b).css("background","#F2F2F2"),a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting")}),0==d.length&&0==e.length?(a(".w-tabs-list").find(".w-tabs-item.active").next().click(),a("html, body").animate({scrollTop:a("#tabsTemp").offset().top},1e3)):0==d.length&&(a(".i_confirm").css("display","inline-block"),a(".i_confirm").prev().find("a").html("<span>Try Again</span>")),a(".w-tabs .w-tabs-section.active input").on("click",function(){a(".i_confirm").hide()}),a(".i_confirm").on("click",function(b){b.preventDefault(),a(this).hide(),a(this).prev().find("a").html("<span>Next</span>"),a(".w-tabs-list").find(".w-tabs-item.active").next().click(),a("html, body").animate({scrollTop:a("#tabsTemp").offset().top},1e3)})},error:function(){a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting"),a("#connectionResult").append("<span class='warning_connect db_status'>We couldn't connect to your server! Please confirm entered data or enter another!</span><br>"),a(".i_confirm").show(),a(".i_confirm").prev().find("a").html("<span>Try Again</span>"),a(".i_confirm").on("click",function(b){b.preventDefault(),a(this).hide(),a(this).prev().find("a").html("<span>Next</span>"),a(".w-tabs-list").find(".w-tabs-item.active").next().click()})}}))},prevStep:function(){a(".prev_step a").on("click",function(b){b.preventDefault(),a("html, body").animate({scrollTop:a("#tabsTemp").offset().top},1e3),a(".w-tabs-list").find(".w-tabs-item.active").prev().click()})},final_tab_conf:function(){a(".download_button a").click(function(b){b.preventDefault(),a("#confirm").prop("checked")&&(a("body").waiting({fixed:!0}),a.ajax({type:"POST",url:ajaxURL,data:{action:"getMyCompile",confirm:a("#confirm").prop("checked")},success:function(b){a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting"),window.location.href=b}}))})},ftp_path:function(){a(".install_button a ").click(function(b){b.preventDefault(),a("#confirm").prop("checked")?(a("#ftp_folder").show(),a(".loadToFTP").show(),a(this).hide()):a("#confirm").parent().css("border-bottom","2px rgba(255,0,0,0.2) solid")})},loadToFTP:function(){a(".loadToFTP a").click(function(b){b.preventDefault(),path=a("#ftp_folder").val(),""==path?(a("#ftp_folder").css("background","rgba(255,0,0,0.2)"),a("#ftp_folder").val("/")):(a("body").waiting({fixed:!0}),a.ajax({type:"POST",url:ajaxURL,data:{action:"getMyCompile",confirm:a("#confirm").prop("checked"),ftpLoad:"load",ftpFolder:path},success:function(b){var c=a.parseJSON(b);a.ajax({type:"POST",url:ajaxURL,data:{action:"unzipFTP",unzip:c.unzip,dump:c.dump},success:function(b){a(".waiting-container.overlay.fixed").remove(),a("body").removeClass("waiting"),a(".loadToFTP a").parent().parent().html("<span class='connected'>Wordpress successfully install to <a href='"+c.link+"'>Your server </a></span>")}})}}))})},generatePassword:function(){a(".generate_password a").click(function(b){b.preventDefault();var c="",d="0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",e=d.length-1;for(i=0;i<10;++i)position=Math.floor(Math.random()*e),c+=d.substring(position,position+1);a("#admin_password").val(c),a("#admin_password").attr("type","text")})},fiveStepFtp:function(){a(".next_step a").click(function(c){c.preventDefault(),a("#tabsTemp div:nth-child(5)").hasClass("active")?(a.ajax({type:"POST",url:ajaxURL,data:{action:"confirmFTP",confirmFTP:"confirmFTP"},success:function(b){var c=a.parseJSON(b);console.log("response.ftp ",c),"ok"==c&&a(".install_button").show(),"fail"==c&&a(".install_button").hide()}}),setTimeout(function(){b.nextStep()},500)):b.nextStep()})},init:function(){b.testFtp(),b.prevStep(),b.final_tab_conf(),b.ftp_path(),b.generatePassword(),b.loadToFTP(),b.fiveStepFtp()}};b.init()})}(jQuery);